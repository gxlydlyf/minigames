<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>贪吃蛇-极简版</title><style>*{margin:0;padding:0}ul{list-style:none}.container{width:1000px;height:800px;margin:10px auto;background-color:#faebd7;position:relative}.food{width:20px;height:20px;background-color:#f08080;position:absolute}.snake_body .cube{position:absolute;width:20px;height:20px;background-color:#bff}.cube.head{background-color:#0493fa}</style></head><body><div class=container><ul class=snake_body></ul></div><script>let container=document.querySelector(".container"),ul_body=document.querySelector(".snake_body"),snake_arr=[{id:0,left:100,top:100,move_direction:"r"},{id:1,left:80,top:100},{id:2,left:60,top:100}];function render_snake(e=!1){e&&(ul_body.innerHTML="");for(let e=snake_arr.length-1;0<=e;e--){var r=document.createElement("li");0==snake_arr[e].id?r.classList.add("cube","head"):(snake_arr[e].id==snake_arr.length-1?r.innerText=e:r.innerText="",r.classList.add("cube")),r.style.left=snake_arr[e].left+"px",r.style.top=snake_arr[e].top+"px",ul_body.append(r)}}function add_body(r=1){for(let e=0;e<r;e++){var t=snake_arr.length;snake_arr.push({id:t,left:snake_arr[t-1].left,top:snake_arr[t-1].top})}render_snake(!0)}function snake_move(){var e=snake_arr[0].move_direction;for(let e=snake_arr.length-1;1<=e;e--)snake_arr[e].left=snake_arr[e-1].left,snake_arr[e].top=snake_arr[e-1].top;switch(e){case"l":snake_arr[0].left-=20;break;case"r":snake_arr[0].left+=20;break;case"u":snake_arr[0].top-=20;break;case"d":snake_arr[0].top+=20}render_snake(!0)}render_snake();let auto_move=setInterval(snake_move,100),lock=!1;function test_key(r){if(!lock){lock=!0;var t=snake_arr[0].move_direction;let e="vertical";("level"!=(e="ArrowLeft"==r||"ArrowRight"==r?"level":"vertical")||"r"!=t&&"l"!=t)&&("vertical"!=e||"u"!=t&&"d"!=t)&&key_change_direction(r),setTimeout(()=>{lock=!1},50)}}function key_change_direction(e){switch(e){case"ArrowLeft":snake_arr[0].move_direction="l";break;case"ArrowRight":snake_arr[0].move_direction="r";break;case"ArrowUp":snake_arr[0].move_direction="u";break;case"ArrowDown":snake_arr[0].move_direction="d";break;default:console.log(e)}}let timer=null;function debounce(e){timer&&clearTimeout(timer),timer=setTimeout(()=>{test_key(e)},50)}function random_food(){var e=Math.floor(Math.random()*container.clientWidth/20),r=Math.floor(Math.random()*container.clientHeight/20),t=document.createElement("div");t.classList.add("food"),t.style.left=20*e+"px",t.style.top=20*r+"px",container.append(t)}function get_position(e){return[e.offsetLeft,e.offsetTop]}function eat_food(){let t,a=document.querySelector(".food"),[n,o]=get_position(a);t=setInterval(()=>{var[e,r]=get_position(document.querySelector(".snake_body .head"));e==n&&r==o&&(clearInterval(t),a.parentElement.removeChild(a),random_food(),eat_food(),add_body(1))},100)}window.addEventListener("keyup",e=>{test_key(e.key)}),random_food(),eat_food();let container_w=container.offsetWidth,container_h=container.offsetHeight,test_failue=setInterval(()=>{(snake_arr[0].left>=container_w||snake_arr[0].left<0||snake_arr[0].top>=container_h||snake_arr[0].top<0||test_body())&&(clearInterval(test_failue),clearInterval(auto_move))},100);function test_body(){console.log(snake_arr[0].move_direction);for(let e=snake_arr.length-1;0<e;e--)if(snake_arr[0].left==snake_arr[e].left&&snake_arr[0].top==snake_arr[e].top)return!0;return!1}</script></body></html>